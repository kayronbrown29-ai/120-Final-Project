<!DOCTYPE html>
<html>
<head>
    <title>UnderDog | My Account</title>
    <link rel="stylesheet" href="login.css">
    <style>
        .account-details {
            margin: 20px 0;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 5px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .account-details p {
            margin: 10px 0;
            font-size: 16px;
        }

        .account-details label {
            font-weight: bold;
            color: #333;
        }

        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn-logout {
            background-color: #4caf50;
            color: rgb(255, 255, 255);
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .btn-logout:hover {
            background-color: #45a049;
        }

        .btn-delete {
            background-color: #ff6b6b;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .btn-delete:hover {
            background-color: #ff5252;
        }

        .not-logged-in {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #ff6b6b;
        }

        .not-logged-in a {
            color: #4caf50;
            text-decoration: none;
            font-weight: bold;
        }

        .not-logged-in a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>

<header class="focalpoint">
    <nav>
        <img src="img/thumbnail_underdog.png" class="nav-icon">
        <ul class="nav-links" style="list-style: none; display: flex; gap: 20px; margin: 0; padding: 0;">
            <li><a href="index.html" style="text-decoration: none; color: inherit;">Home</a></li>
            <li><a href="menu.html" style="text-decoration: none; color: inherit;">Menu</a></li>
            <li class="signup-item"><a href="sign-up.html" style="text-decoration: none; color: inherit;">Sign Up</a></li>
            <li class="login-item"><a href="login.html" style="text-decoration: none; color: inherit;">Log In</a></li>
            <li class="myaccount-item" style="display: none;"><a href="my-account.html" style="text-decoration: none; color: inherit;">My Account</a></li>
            <li class="logout-item" style="display: none;"><a href="#" onclick="logout(); return false;" style="text-decoration: none; color: inherit;">Log Out</a></li>
        </ul>
    </nav>

    <script>
        // Update navbar based on login state
        function updateNavbar() {
            const isLoggedIn = localStorage.getItem("isLoggedIn");
            
            if (isLoggedIn === "true") {
                const signupItem = document.querySelector('.signup-item');
                const loginItem = document.querySelector('.login-item');
                const myaccountItem = document.querySelector('.myaccount-item');
                const logoutItem = document.querySelector('.logout-item');
                
                if (signupItem) signupItem.style.display = 'none';
                if (loginItem) loginItem.style.display = 'none';
                if (myaccountItem) myaccountItem.style.display = 'block';
                if (logoutItem) logoutItem.style.display = 'block';
            }
        }
        
        updateNavbar();
        // Hide the small nav logout link on this page (we show a larger Log Out button below)
        const navLogout = document.querySelector('.nav-links .logout-item');
        if (navLogout) navLogout.style.display = 'none';
    </script>

    <br><br>

    <article class="account-form">
        <h1>My Account</h1>

        <div id="logged-in-content" style="display: none;">
            <div class="account-details">
                <p><label>Username:</label> <span id="username-display"></span></p>
                <p><label>Email:</label> <span id="email-display"></span></p>
                <p><label>Account Status:</label> <span style="color: #4caf50;">Active</span></p>
            </div>

            <div class="button-group">
                <button onclick="logout()" class="btn-logout">Log Out</button>
                <button onclick="deleteAccount()" class="btn-delete">Delete Account</button>
            </div>
        </div>

        <div id="not-logged-in-content" style="display: none;">
            <div class="not-logged-in">
                <p>You are not logged in.</p>
                <p><a href="login.html">Log In</a> or <a href="sign-up.html">Sign Up</a> to view your account.</p>
            </div>
        </div>
    </article>
</header>

<script src="script.js"></script>

<script>
    // Check if user is logged in and populate account details
    function initializeAccountPage() {
        const currentUserData = localStorage.getItem('CurrentUser');
        const isLoggedIn = localStorage.getItem('isLoggedIn');

        if (isLoggedIn === 'true' && currentUserData) {
            try {
                const user = JSON.parse(currentUserData);
                document.getElementById('username-display').textContent = user.username || 'N/A';
                document.getElementById('email-display').textContent = user.email || 'N/A';
                document.getElementById('logged-in-content').style.display = 'block';
                document.getElementById('not-logged-in-content').style.display = 'none';
            } catch (e) {
                console.error('Error parsing user data:', e);
                document.getElementById('not-logged-in-content').style.display = 'block';
                document.getElementById('logged-in-content').style.display = 'none';
            }
        } else {
            document.getElementById('not-logged-in-content').style.display = 'block';
            document.getElementById('logged-in-content').style.display = 'none';
        }
    }

    // Run on page load
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeAccountPage);
    } else {
        initializeAccountPage();
    }

    function logout() {
        localStorage.removeItem("CurrentUser");
        localStorage.removeItem("isLoggedIn");
        localStorage.removeItem("loggedInEmail");
        alert("Logged out successfully!");
        window.location.href = "index.html";
    }
</script>

</body>
</html>
